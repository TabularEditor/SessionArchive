{
  "name": "Forecast MTD",
  "expression": [
    "",
    "-- Calculates the target for the current month/year selection",
    "VAR _CURRENT_MONTH_VALUE =",
    "    CALCULATE (",
    "        [Forecast],",
    "        ALL ( 'Date' ),",
    "        VALUES ( 'Date'[Calendar Month Year (ie Jan 21)] )",
    "    ) ",
    "",
    "-- Computes rate at which Forecast increases through the month",
    "VAR _CURRENT_MONTH_PERC_WORKDAYS_MTD =",
    "    POWER (",
    "        CALCULATE (",
    "            MAX ( 'Date'[Workdays MTD %] ),",
    "            'Date'[IsDateInScope] = TRUE",
    "        ),",
    "        1.035",
    "    )",
    "",
    "VAR _CURRENT_MONTH_PERC_WORKDAYS =",
    "    POWER (",
    "        CALCULATE (",
    "            MAX ( 'Date'[Workdays MTD %] )",
    "        ),",
    "        1.035",
    "    )",
    "",
    "VAR _PERIOD =",
    "    SELECTEDVALUE (",
    "        '4) Selected Period'[Period]",
    "    )",
    "VAR _HASONEMONTH =",
    "    HASONEVALUE (",
    "        'Date'[Calendar Month Year (ie Jan 21)]",
    "    )",
    "RETURN",
    "    -- return MTD value if a month is selected",
    "    IF.EAGER (",
    "        _HASONEMONTH",
    "            && _PERIOD = \"Full Period\",",
    "        _CURRENT_MONTH_PERC_WORKDAYS",
    "            * _CURRENT_MONTH_VALUE,",
    "",
    "        IF (",
    "            _HASONEMONTH,",
    "            _CURRENT_MONTH_PERC_WORKDAYS_MTD",
    "                * _CURRENT_MONTH_VALUE",
    "        )",
    "    )"
  ],
  "formatString": "#,##0",
  "displayFolder": "Measures\\ii. MTD",
  "lineageTag": "59b4471b-3cce-43f5-ab24-5555faf2bd37"
}