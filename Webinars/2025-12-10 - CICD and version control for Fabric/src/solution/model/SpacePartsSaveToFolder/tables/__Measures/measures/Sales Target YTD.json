{
  "name": "Sales Target YTD",
  "expression": [
    "",
    "VAR YRTD =",
    "    CALCULATE(",
    "        [Sales Target],",
    "        CALCULATETABLE(",
    "            DATESYTD( 'Date'[Date] ),",
    "            'Date'[IsDateInScope] = TRUE",
    "        ),",
    "        'Date'[IsBeforeThisMonth] = TRUE",
    "    ) // Calculates the target for the current month/year selection",
    "VAR _CurrentMonth_value =",
    "    CALCULATE( [Sales Target], 'Date'[IsThisMonth] = TRUE ) // Calculates the % workdays MTD together with the dynamic parameter to set the exponential rate of increase MTD",
    "VAR _currentMonthWorkDay =",
    "    POWER(",
    "        CALCULATE(",
    "            MAX( 'Date'[Workdays MTD %] ),",
    "            'Date'[IsDateInScope] = TRUE,",
    "            'Date'[IsThisMonth] = TRUE",
    "        ),",
    "        0.93",
    "    ) // If viewing units, hide the FCST (as there is no units FCST as of July 09, 2020)",
    "VAR MOTD =",
    "    IF(",
    "        _CurrentMonth_value > 0,",
    "        _currentMonthWorkDay * _CurrentMonth_value,",
    "        BLANK( )",
    "    )",
    "        + YRTD",
    "VAR _PERIOD = SELECTEDVALUE( '4) Selected Period'[Period] )",
    "VAR _YEAR = MAX( 'Date'[Calendar Year Number (ie 2021)] )",
    "VAR _MONTH = MAX( 'Date'[Calendar Year Month (ie 202101)] )",
    "RETURN",
    "    IF(",
    "        _PERIOD = \"Full Period\",",
    "        CALCULATE(",
    "            [Sales Target],",
    "            ALL( 'Date' ),",
    "            'Date'[Calendar Year Number (ie 2021)] = _YEAR,",
    "            'Date'[Calendar Year Month (ie 202101)] <= _MONTH",
    "        ),",
    "        // If date is in the visual context and YTD is blank, show MTD, otherwise add YTD + MTD together",
    "        MOTD",
    "    )"
  ],
  "formatString": "#,##0",
  "displayFolder": "4. YTD",
  "lineageTag": "8baefb39-9d1b-40ad-9ad5-4f9c9c310095"
}